<?php

	/**
	 *
	 * ==================== [DONT TOUCH THIS FILE!] ====================
	 *
	 *		This is the core look and feel for the entire admin section.
	 *		from here we load individual registered admin modules that
	 *		then add to this page based on what page the user is on.
	 *		
	 *		@author: Adam Balan
	 *		@version: 1.0
	 *		@package: AisisCore->AdminPanel->Modules
	 *
	 * =================================================================
	 */
	 
	 //check theme version
	 $aisis_check_version = new AisisUpdate();
	 $options = get_option('aisis_core_theme_setting_sidebar_global');
	 $option_update = get_option('aisis_core_theme_setting_silent_update'); 
	 
	 //check if auto update is enabled and do the appropriate checks.
	 if($option_update['turn_on_silent_update'] == 1){
		 $aisis_check_version->auto_silent_update();
	 }
?>
    <div id="top">
        <div class="title">
            Aisis Core Theme Options <?php echo $aisis_check_version->get_current_theme_version();?>
    	</div>
       <?php if($option_update['turn_on_silent_update'] != 1){$aisis_check_version->check_for_update_with_message(); }?>
	</div>
       

	<?php
    //Check for messages
    check_for_aisis_messages();
	
    if(isset($_GET['page']) && $_GET['page'] == 'aisis-core-options'){
        aisis_admin_options_page();
    }
    else if(isset($_GET['page']) && $_GET['page'] == 'aisis-css-editor'){
        aisis_css_editor_page();
    }
    else if(isset ($_GET['page']) && $_GET['page'] == 'aisis-js-editor'){
        aisis_js_editor_page();
    }
    else if(isset ($_GET['page']) && $_GET['page'] == 'aisis-php-editor'){
        aisis_php_editor_page();
    }
    else if(isset ($_GET['page']) && $_GET['page'] == 'aisis-core-update'){
        aisis_core_update_page();
    }
    ?>
    
    </div>
    <script>
	/**
	 * Core functionality upon page load.
	 */
	$(function() {
		$( "#coreTabs" ).tabs();
		
		enableSideBar();
		$('#sidebar_global').click(enableSideBar)
		enableSliderMini();
		$('#slider_mini_global').click(enableSliderMini)			
	});
	
	/**
	 * If the user has chosen to not show the
	 * the sidebar across the site keep the
	 * rest disabled.
	 */
	function enableSideBar(){
		if(this.checked){
			$('input.sidebar').attr("disabled", true);
		}else{
			<?php
			if(isset($options['no_sidebar_global']) && $options['no_sidebar_global'] != 1){
			?>
			$('input.sidebar').removeAttr('disabled');
			<?php
			}
			?>
			
		}
	}
	
	/**
	 * If the user has chosen to not show the
	 * the slider and mini feed across the site keep the
	 * rest disabled.
	 */		
	function enableSliderMini(){
		if(this.checked){
			$('input.slider_mini').attr("disabled", true);
		}else{
			<?php
			if(isset($options['no_slider_mini_global']) && $options['no_slider_mini_global'] != 1){
			?>
			$('input.slider_mini').removeAttr('disabled');
			<?php
			}
			?>
			
		}
	}
	
	/**
	 * This is used for the media uploader for when we are
	 * uploading images for the author banner.
	 */        
	jQuery(document).ready(function() {
		jQuery('#upload_image_button').click(function() {
			formfield = jQuery('#upload_image').attr('name');
			tb_show('', 'media-upload.php?type=image&TB_iframe=true');
			return false;
		});
	
		window.send_to_editor = function(html) {
			imgurl = jQuery('img',html).attr('src');
			jQuery('#upload_image').val(imgurl);
			tb_remove();
		}
		
		jQuery('#upload_image_button').click(function() {
			formfield = jQuery('#upload_image').attr('name');
			tb_show('', 'media-upload.php?type=image&TB_iframe=true');
			return false;
		});
	
		window.send_to_editor = function(html) {
			imgurl = jQuery('img',html).attr('src');
			jQuery('#aisis_header_img').val(imgurl);
			tb_remove();
		}			
	
	});	
	</script>